<!doctype html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1" name="viewport" />

    <title>Omelosz városa - A Boldogság városa (alap)</title>  <!-- modify_Title -->
    
    <link rel="stylesheet" type="text/css" href="/index.css">
    <link rel="stylesheet" type="text/css" href="/main.css">
    
    <!-- Adatbázis -->
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.9.3/firebase-firestore.js"></script>
    <script>
      var _0x3452=['https://ethicapp-6b9fe.firebaseio.com','ethicapp-6b9fe.appspot.com','ethicapp-6b9fe','1:510889098350:web:0ea70d679f8186faa5ba7f','510889098350','AIzaSyC2c9URhaeXmNhm4Ds8h8Cftmev3jmHh50','ethicapp-6b9fe.firebaseapp.com'];(function(_0x202094,_0x3452f1){var _0x2365e0=function(_0x9a4b06){while(--_0x9a4b06){_0x202094['push'](_0x202094['shift']());}};_0x2365e0(++_0x3452f1);}(_0x3452,0xeb));var _0x2365=function(_0x202094,_0x3452f1){_0x202094=_0x202094-0x0;var _0x2365e0=_0x3452[_0x202094];return _0x2365e0;};var firebaseConfig={'apiKey':_0x2365('0x1'),'authDomain':_0x2365('0x2'),'databaseURL':_0x2365('0x3'),'projectId':_0x2365('0x5'),'storageBucket':_0x2365('0x4'),'messagingSenderId':_0x2365('0x0'),'appId':_0x2365('0x6')};
      
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
    </script>
        
    <!-- Szkriptek -->
    <script src="/text.js" type="text/javascript"></script>
    
    <!-- About 19 ITEMS to change(_modificate_) each time! -->
  </head>
  <body>
    <header>
      <div class="container">
        <a href="/index.html"><img class="logo" src="https://cdn.glitch.com/9ba797a4-fa1f-41d6-85dc-e6295ca8644e%2FEthicAppLOGO_02.png?v=1587214486453"></a>
        <navbar class="menu">
          <li><a href="/index.html">Kezdőlap</a></li>
          <li><a href="/about.html">Rólunk</a></li>
        </navbar>
      </div>
    </header>
    <content>
    <div class="content">
      <div class="section">
        <div class="section2">
          <div class="section3">
          <!-- DIV/SPAN/P -->
            <div id="intro">
              <h1 id="welcome_Title"><script>welcomeTitle();</script></h1>

              <p id="welcome_Text"><script>welcomeText();</script></p>

              <h2 id="title_AB"><script>titleAB();</script></h2>
            </div>
            <form id="f1">	<!-- Űrlap nyitás -->
			        <fieldset>
                <legend><b>Omelosz városa - A Boldogság városa (alap)</b></legend>  <!-- modify_Title -->
                <div>
                  <div class="texts">  <!-- modify_Description -->
                    Omelos városában nincs helye a boldogtalanságnak. Ezen a kis, fiktív helyen senkinek sincs semmi gondja. Habár elsőre
                   tökéletesnek tűnhet ez a hely, a felszín alatt mégis hamis lehet a beállított utópia. Sok évvel ezelőtt jött a világra egy lány, akit
                    születése után a város polgárai elzártak egy sötét pincébe, hogy biztosítsák a város boldogságát. Lent a mélyben, sötétben, szennyben,
                   kínzó egyedüllét mellett kellett élnie mindennapjait. Lehet ez a lány még sohasem beszélt senkivel, nem tudott meg semmit a külvilágról. 
                    Valószínűleg emiatt nem is lehet mentálisan teljesen rendben, de ezt az életet ő megérdemli? A többi ember boldogságának érdekében megérdemli
                   ez a lány a sok szenvedést? A kérdés a következő: Élnél a városban ezek tekintetében?
                  </div>  

                  <!-- modify_Picture + :picture_alt: -->
                  <div class="row">
                    <div class="column leftCol">               
                      <img src="https://cdn.glitch.com/9ba797a4-fa1f-41d6-85dc-e6295ca8644e%2FCharisLoke_Omelas.jpg?v=1589282751614"
                           alt="CharisLoke_Omelas" class="pics stillPics">
                    </div>
                    <div class="column rightCol"> 
                    </div>
                  </div>

                  <!-- modify_labelName -->
                  <label class="checkboxContainer">Igen, és nem zavarna, ha ezzel a tudattal kellene élnem 
                    <input type="radio" id="elso" value="elso" name="options">
                    <span class="checkmark"></span>
                  </label>
                  
                  <!-- modify_labelName -->
                  <label class="checkboxContainer">Nem élnék ezen a helyen
                    <input type="radio" id="masodik" value="masodik" name="options">      
                    <span class="checkmark"></span>
                  </label>
                </div>
			        </fieldset>
              <div> <!-- Űrlap küldése vagy törlése -->
                <input id="kuldes" type="button" value="Küldés" onclick="w3.hide('#intro'); w3.hide('#f1'); w3.show('#results'); w3.show('#stats'); afterClick();">

                <input id="torles" type="reset" name="torles" value="Törlés">
              </div>  
		      </form>	<!-- Űrlap zárás -->
             
          <!-- "Második Oldal" -->
          <div class="row chartsRow"> 
            <div class="column chartsLeftCol">  
              <div id="results">
                <p id="empty"></p>
              </div>
            </div> 
            <div class="column chartsRightCol"> 
             <div id="stats">
                <h2>Omelosz városa - A Boldogság városa (alap)</h2>    <!-- modify_Title -->
                <canvas id="chart" width="400" height="150"></canvas>
              </div>
            </div>
          </div> 
          <!-- "Második Oldal Alja" --> 
          </div>
        </div>
      </div>
    </div>
    </content>
    <footer>
      <div>
        <h3>(C) Király Márk, Kovács Alex</h3>
      </div>
    </footer>
    
    <!-- Szkriptek -->
    <script src="https://www.w3schools.com/lib/w3.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>
    <script>
      var database = firebase.firestore(); 
      
      var val = "null";
      
      var count = 0;
      
      var szitu_0sum=0;
      var szitu_1sum=0;
      
      function afterClick() {
        
        if(document.getElementById('elso').checked){
          val = 0;    //adatok felküldéséhez
          document.getElementById("empty").innerHTML = "Ebben a városban éled tovább napjaidat";        //modify_Answer 
        }
        
        if(document.getElementById('masodik').checked){
          val = 1;    //adatok felküldéséhez
          document.getElementById("empty").innerHTML = "Elhagyod a várost";      //modify_Answer 
        }
         
        if(val == "null"){
          
          document.getElementById("empty").innerHTML = "Nem adtál választ";            //modify_Answer 
        }
        
        //adatok felküldése adatbázisba
        if(val != "null"){
            database.collection("dilemma").add({
              szitu6: val                            //modify_szitu
          })
            .then(function(docRef) {
              console.log("Document written with ID: ", docRef.id);
          })
            .catch(function(error) {
               console.error("Error adding document: ", error);
          });
        }

      //az egész 'dilemma' adattár lekérése adatbázisból
      // 2 hours spent here  
      database.collection("dilemma").get().then((querySnapshot) => {   

        querySnapshot.forEach((doc) => {
          console.log(`${doc.data().szitu6}`);      //modify_szitu
          if(`${doc.data().szitu6}` == 0){          //modify_szitu
            szitu_0sum++;
          }
          if(`${doc.data().szitu6}` == 1){          //modify_szitu
            szitu_1sum++;
          }
          //for debugging
          /*
          if(`${doc.data().szitu1}`.match(/null/g)){  //"null" handle    //(modify_szitu)
            count++;  
            console.log("Val értéke null: " + count);

          }*/   
        });
        console.log("Felhasználó válasz összesítés, szitu nullák: " + szitu_0sum);
        console.log("Felhasználó válasz összesítés, szitu eggyek: " + szitu_1sum);

        var ctx = document.getElementById('chart').getContext('2d');
        var myChart = new Chart(ctx, {
          type: 'pie',
          data: {
            labels: ['A városban élek tovább','Elhagyom a várost'],        //modify_Labels
            datasets: [{
              label: "options",
              data: [szitu_0sum,szitu_1sum],
              backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(153, 102, 255, 0.2)'
              ],
              borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(153, 102, 255, 1)'
              ],
              borderWidth: 1,
            }]
          },
          options: {
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
                }
              }
          });   
      });
    } /* Afterclick Function vége */
    </script>
    <script>
      w3.hide('#stats');
      w3.show('#results');
    </script>	
  </body>
</html>